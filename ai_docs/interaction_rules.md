# Правила взаимодействия с пользователем

## Система управления задачами

### Использование todo.txt
- **Всегда** использовать оригинальный синтаксис todo.txt со всеми возможностями
- Синхронизировать внутреннюю систему TodoWrite с файлом todo.txt
- Форматы приоритетов: `(A)` высокий, `(B)` средний, `(C)` низкий
- Контексты: `@ai`, `@wait_user`, `@from_user` 
- Проекты: `project:название`
- Теги: `+тег1 +тег2`
- Даты: `due:2025-01-15`, `completed:2025-01-09`, `created:2025-01-09`

### Контексты выполнения
- `@ai` - задачи для выполнения ИИ
- `@wait_user` - ожидание действий пользователя
- `@from_user` - задачи на основе информации от пользователя

## Структура проекта

### Папки назначения
- `ai_docs/` - вся информация для ИИ
- `ai_docs/to_user/` - вопросы и задачи для пользователя  
- `legacy/` - устаревшие файлы и старые версии
- `schedule_processor/` - основные модули системы

### Принцип чистоты кода
- **Всегда** проверять изменения через ruff и добиваться чистого вывода
- **Всегда** типизировать в Python (вообще всё что можно типизировать)
- Для CLI использовать библиотеку click и только её
- Для тестов использовать pytest

### Версии кода
- Все старые версии (`v1`, `v3`) перенесены в папку `legacy/`
- `v2` была удалена пользователем как неактуальная
- Избыточные файлы перемещать в папку `legacy/`
- После изменений в коде **ВСЕГДА** включать обновление документации в todo

## Конфигурация

### Настройки логирования
- **НЕ ЗАНОСИТЬ** настройки логирования в конфиг
- Логирование настраивается в коде приложений

### YAML конфигурация
- Использовать config.yaml для всех настроек системы
- Обеспечить обратную совместимость со старыми константами
- Выделить неизвестные параметры в отдельную секцию `unknown_parameters`

## Документация

### Файлы to_user/
- Удалять неактуальные кейсы когда получена информация
- Оставлять только текущие блокирующие вопросы
- Указывать четкие инструкции для решения задач

### Сохранение информации от пользователя
- Все правила взаимодействия записывать в ai_docs
- Специфику СЗГМУ сохранять в config.yaml секция `academic_szgmu`
- Ответы пользователя интегрировать в конфигурацию

## Специфика СЗГМУ

### Система заявлений
- Для каждой дисциплины отдельное заявление
- Одна объяснительная записка в дирекцию института  
- Всё печатать, подписывать, относить лично

### Система отработок
- Всё индивидуально, зависит от преподавателя и кафедры
- Срок отработки: в течение месяца
- Влияет на КНЛ/КНС (нужно читать положение)

### Подгруппы и группы  
- Подгруппы используются только для разделения на занятия
- Поле subgroup в API избыточное
- Семинары одинаковы для всей группы, не подгруппы

### Учебные планы
- Размещены в SDO Moodle (sdo.szgmu.ru)
- Доступ по логину и паролю студента
- Всё слишком индивидуально для автоматизации
- Студент может подгружать темы самостоятельно

### Экзамены
- Расписание: https://szgmu.ru/rus/m/660/
- Обновления появляются там в первую очередь
- PDF файлы без стандартной структуры
- Других форматов нет

### Академический календарь
- Семестры начинаются "как прикажет ректор"
- Исключений по факультетам нет
- На праздники и каникулы не ставят занятия в расписание

### Преподаватели
- Для групп обычно закрепляется ведущий преподаватель (не куратор)
- Было бы неплохо указывать препода в расписании
- На документооборот не влияет

## Инструменты

### Конвертация документов (Arch Linux, без AUR)
- Рекомендуется: LibreOffice CLI (`sudo pacman -S libreoffice-fresh`)
- Альтернативы: pandoc, antiword
- Команда: `libreoffice --headless --convert-to txt file.doc --outdir output/`

### Направления подготовки
- ЛД = Лечебное дело  
- МПД = Медико-профилактическое дело
- Это направления подготовки, не факультеты
- Особенностей в документообороте по направлениям нет

## Приоритеты разработки

### Высокий приоритет (A)
- Конвертация документов для понимания КНЛ/КНС системы
- Чтение положения о текущем контроле успеваемости

### Средний приоритет (B)  
- Исправление кода бота согласно UX
- Система заявлений на пропуски
- Добавление типизации

### Низкий приоритет (C)
- Интеграция с расписанием экзаменов
- Тестирование
- Интеграция с SDO Moodle